<!DOCTYPE html>
<html>
<head>
    <title>Map View - Carpool DApp</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #map { 
            height: 500px; 
            width: 100%; 
            background: linear-gradient(45deg, #e3f2fd, #bbdefb);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sidebar { 
            background-color: #f8f9fa; 
            padding: 20px; 
            height: 100vh; 
            overflow-y: auto; 
        }
        .ride-card {
            border-left: 4px solid #007bff;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="{% url 'UserScreen' %}">Carpool DApp - Map View</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">Welcome, {{ user }}</span>
                <a class="nav-link" href="{% url 'UserScreen' %}">Back to Dashboard</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-4 sidebar">
                <h4>üîç Find Nearby Rides</h4>
                
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">üìç Your Location</label>
                            <input type="text" id="locationInput" class="form-control" placeholder="e.g., Downtown Station">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">üéØ Destination</label>
                            <input type="text" id="destinationInput" class="form-control" placeholder="e.g., City Center Mall">
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">üìè Search Radius</label>
                                <select id="radiusSelect" class="form-select">
                                    <option value="1">1 mile</option>
                                    <option value="3" selected>3 miles</option>
                                    <option value="5">5 miles</option>
                                    <option value="10">10 miles</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">üë• Seats Needed</label>
                                <input type="number" id="seatsInput" class="form-control" value="1" min="1" max="8">
                            </div>
                        </div>
                        <button onclick="findRides()" class="btn btn-primary w-100 mb-3">
                            üöó Find Available Rides
                        </button>
                    </div>
                </div>

                <!-- Ride Results -->
                <div id="rideResults">
                    <div class="alert alert-info">
                        <h6>How to Use Map View</h6>
                        <p>Enter your location and destination to find nearby drivers.</p>
                        <p>Available rides will appear here and on the map.</p>
                        <hr>
                        <a href="{% url 'ViewDrivers' %}" class="btn btn-sm btn-outline-primary">
                            Use Coordinate-Based Search Instead
                        </a>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h6>‚ö° Quick Actions</h6>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <a href="{% url 'ViewDrivers' %}" class="btn btn-outline-primary btn-sm">
                                üîÑ Refresh Rides
                            </a>
                            <a href="{% url 'Ratings' %}" class="btn btn-outline-warning btn-sm">
                                ‚≠ê Rate Previous Rides
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Map Area -->
            <div class="col-md-8 p-4">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">üó∫Ô∏è Interactive Map</h5>
                    </div>
                    <div class="card-body p-0">
                        <div id="map">
                            <div class="text-center p-5">
                                <div class="mb-3">
                                    <i class="fas fa-map-marked-alt" style="font-size: 48px; color: #6c757d;"></i>
                                </div>
                                <h4>Interactive Map View</h4>
                                <p class="text-muted">This area would display Google Maps with real-time ride locations</p>
                                <div class="mt-3">
                                    <div class="row text-start">
                                        <div class="col-md-6">
                                            <small>‚úÖ Driver locations</small><br>
                                            <small>‚úÖ Route visualization</small><br>
                                            <small>‚úÖ Distance calculation</small>
                                        </div>
                                        <div class="col-md-6">
                                            <small>‚úÖ Real-time tracking</small><br>
                                            <small>‚úÖ ETA estimates</small><br>
                                            <small>‚úÖ Traffic conditions</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <button onclick="showSampleRides()" class="btn btn-success">
                                        Show Sample Rides
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sample Ride Data (for demo) -->
                <div id="sampleRides" class="mt-3" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h6>Sample Available Rides (Demo)</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="ride-card card p-3 mb-2">
                                        <h6>üöó John's Toyota Camry</h6>
                                        <small>üìç Downtown ‚Üí City Center</small><br>
                                        <small>‚è∞ 2:30 PM | üë• 3 seats</small><br>
                                        <small>üí∞ 15 CPT | üö¶ 5 min away</small>
                                        <button class="btn btn-sm btn-primary mt-2">Request Ride</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="ride-card card p-3 mb-2">
                                        <h6>üöô Sarah's Honda Civic</h6>
                                        <small>üìç Main St ‚Üí University</small><br>
                                        <small>‚è∞ 3:00 PM | üë• 2 seats</small><br>
                                        <small>üí∞ 12 CPT | üö¶ 8 min away</small>
                                        <button class="btn btn-sm btn-primary mt-2">Request Ride</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample ride data for demo
        const sampleRides = [
            {
                driver: "John_D",
                location: "Downtown Station",
                destination: "City Center Mall",
                time: "14:30",
                seats: 3,
                price: 15,
                distance: "0.8 miles"
            },
            {
                driver: "Sarah_W", 
                location: "Main Street",
                destination: "University Campus",
                time: "15:00",
                seats: 2,
                price: 12,
                distance: "1.2 miles"
            },
            {
                driver: "Mike_T",
                location: "Central Park",
                destination: "Airport",
                time: "16:15", 
                seats: 4,
                price: 25,
                distance: "2.5 miles"
            }
        ];

        function findRides() {
            const location = document.getElementById('locationInput').value;
            const destination = document.getElementById('destinationInput').value;
            const radius = document.getElementById('radiusSelect').value;
            const seats = document.getElementById('seatsInput').value;
            
            if (!location) {
                alert('Please enter your current location');
                return;
            }
            
            const resultsDiv = document.getElementById('rideResults');
            
            // Show loading
            resultsDiv.innerHTML = `
                <div class="alert alert-warning">
                    <div class="spinner-border spinner-border-sm me-2" role="status"></div>
                    Searching for rides from <strong>${location}</strong> to <strong>${destination}</strong>...
                </div>
            `;
            
            // Simulate API call delay
            setTimeout(() => {
                let html = `
                    <div class="alert alert-success">
                        <h6>üéâ Found ${sampleRides.length} Available Rides!</h6>
                        <p>Within ${radius} miles of <strong>${location}</strong></p>
                    </div>
                `;
                
                sampleRides.forEach((ride, index) => {
                    html += `
                        <div class="card ride-card mb-2">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h6>üöó ${ride.driver}</h6>
                                        <small class="text-muted">
                                            üìç ${ride.location} ‚Üí ${ride.destination}<br>
                                            ‚è∞ ${ride.time} | üë• ${ride.seats} seats<br>
                                            üí∞ ${ride.price} CPT | üìè ${ride.distance} away
                                        </small>
                                    </div>
                                    <div>
                                        <button class="btn btn-sm btn-success" onclick="requestRide(${index})">
                                            Request Ride
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                resultsDiv.innerHTML = html;
                
                // Show sample rides on map area
                showSampleRides();
                
            }, 1500);
        }

        function showSampleRides() {
            document.getElementById('sampleRides').style.display = 'block';
            document.getElementById('map').innerHTML = `
                <div class="text-center p-4">
                    <div class="mb-3">
                        <i class="fas fa-car-side" style="font-size: 48px; color: #28a745;"></i>
                        <i class="fas fa-map-marker-alt ms-3" style="font-size: 48px; color: #dc3545;"></i>
                        <i class="fas fa-road ms-3" style="font-size: 48px; color: #ffc107;"></i>
                    </div>
                    <h4 class="text-success">Live Ride Map Active</h4>
                    <p class="text-muted">3 drivers found in your area</p>
                    <div class="mt-3">
                        <div class="badge bg-success me-2">John - 0.8mi</div>
                        <div class="badge bg-warning me-2">Sarah - 1.2mi</div>
                        <div class="badge bg-info">Mike - 2.5mi</div>
                    </div>
                </div>
            `;
        }

        function requestRide(rideIndex) {
            const ride = sampleRides[rideIndex];
            alert(`Ride requested with ${ride.driver}!\n\nWe're connecting you with the driver. Please check your dashboard for ride confirmation.`);
            
            // Redirect to main dashboard where they can see actual rides
            setTimeout(() => {
                window.location.href = "{% url 'UserScreen' %}";
            }, 2000);
        }

        // Initialize with some sample data
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('locationInput').value = 'Downtown Station';
            document.getElementById('destinationInput').value = 'City Center Mall';
        });
    </script>

    <!-- Add Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</body>
</html>